---
title: "Comparative study of the state of gender equality in the labour market between European countries"
subtitle: "Data science project"
author: "Manueal Zonon, Lucie Aracil, Gwendoline Viquesnel"
date: '`r format(Sys.Date(), "%d %B, %Y")`' # generate date automatically (voir si on peux mettre 25 novembre au lieu de novembre 25)
output: 
  html_document: 
    code_folding: hide
    highlight: tango
    theme: spacelab
    toc: yes
---

```{r, include=FALSE}
# Downloading require packages 

library(eurostat)
library(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(lubridate)
library(car)
library(RMySQL)
library(survival)
library(mapproj)
library(mosaic)
library(scales)
library(grid)
library(ggrepel)
library(ggthemes)
library(gganimate)
library(gifski)
library(av)
library(magick)


# Downloading and naming the data frame from eurostat
doc1 <- get_eurostat(id= "lfsi_emp_a", time_format = "date", filters = "none", type = "code", cache = TRUE)
doc2 <- get_eurostat(id= "lfsa_ergaed", time_format = "date", filters = "none", type = "code", cache = TRUE)
doc3 <- get_eurostat(id= "lfsa_eppgan", time_format = "date", filters = "none", type = "code", cache = TRUE)
doc4 <- get_eurostat(id= "lfsa_etgar", time_format = "date", filters = "none", type = "code", cache = TRUE)
doc5 <- get_eurostat(id= "une_rt_a", time_format = "date", filters = "none", type = "code", cache = TRUE)
doc6 <- get_eurostat(id= "une_ltu_a", time_format = "date", filters = "none", type = "code", cache = TRUE)
doc7<- get_eurostat(id= "demo_gind", time_format = "date", filters = "none", type = "code", cache = TRUE)
doc8<- get_eurostat(id= "nama_10_gdp", time_format = "date", filters = "none", type = "code", cache = TRUE)
doc9<- get_eurostat(id= "earn_gr_gpgr2", time_format = "date", filters = "none", type = "code", cache = TRUE)   
doc10<- get_eurostat(id= "demo_fasec", time_format = "date", filters = "none", type = "code", cache = TRUE) 

# Check if there are missing values
any(is.na(doc1))
any(is.na(doc2))
any(is.na(doc3))
any(is.na(doc4))
any(is.na(doc5))
any(is.na(doc6))
any(is.na(doc7))
any(is.na(doc8))
any(is.na(doc9))
any(is.na(doc10))

# Remove NA
doc2=na.omit(doc2)
doc3=na.omit(doc3)
doc4=na.omit(doc4)
doc6=na.omit(doc6)
doc7=na.omit(doc7)
doc8=na.omit(doc8)
doc9=na.omit(doc9)

# Check if the missing value are gone
sum(is.na(doc2)) 
sum(is.na(doc3)) 
sum(is.na(doc4)) 
sum(is.na(doc6)) 
sum(is.na(doc7)) 
sum(is.na(doc8)) 
sum(is.na(doc9)) 

# Set date format
doc1$time <- format(doc1$time, "%Y")
doc2$time <- format(doc2$time, "%Y")
doc3$time <- format(doc3$time, "%Y")
doc4$time <- format(doc4$time, "%Y")
doc5$time <- format(doc5$time, "%Y")
doc6$time <- format(doc6$time, "%Y")
doc7$time <- format(doc7$time, "%Y")
doc9$time <- format(doc9$time, "%Y")
doc10$time <- format(doc10$time, "%Y")

# Only the doc8 is not as date so we change it in date format before
class(doc8$time)
doc8$time=as.Date(doc8$time,"%Y-%m-%d")
doc8$time <- format(doc8$time,"%Y")

# Filter to keep data from 2006 
doc1=doc1 %>% filter(time>=2006)
doc2=doc2 %>% filter(time>=2006)
doc3=doc3 %>% filter(time>=2006)
doc4=doc4 %>%filter(time>=2006)
doc6=doc6 %>%filter(time>=2006)
doc7=doc7 %>% filter(time>=2006)
doc8=doc8 %>% filter(time>=2006)
doc9=doc9 %>% filter(time>=2006)

# Filter to keep data from 20-64 year old category
doc1=doc1%>% filter(age== "Y20-64")
doc2=doc2%>% filter(age== "Y20-64")
doc3=doc3%>% filter(age== "Y20-64")
doc4=doc4%>% filter(age== "Y20-64")
doc6=doc6%>% filter(age== "Y20-64")
doc5=doc5%>% filter(age== "TOTAL")
doc10=doc10%>% filter(age== "TOTAL",sex=="T")

# Delete age column
doc1=doc1%>% select(-"age")
doc2=doc2%>% select(-"age")
doc3=doc3%>% select(-"age")
doc4=doc4%>% select(-"age")
doc5=doc5%>% select(-"age")
doc6=doc6%>% select(-"age")
doc10=doc10%>% select(-"age")

# we keep just PC (pourcentage) unit column
doc1=doc1%>% filter(unit== "PC_POP")
doc1=doc1%>% select(-"unit")
doc2=doc2%>% select(-"unit")
doc3=doc3%>% select(-"unit")
doc9=doc9%>% select(-"unit")
doc10=doc10%>% select(-"unit",-"sex")

# Rename columns, rename labels inside columns, suppress useless stuffs and rename documents

## doc 1 : PC_Act
doc1 <- doc1 %>% 
  rename(country=geo, category=indic_em) 
doc1$category <- car::recode(doc1$category,'"ACT"="Actif"')
doc1$category <- car::recode(doc1$category,'"EMP_LFS"="Total_Employment"')
PC_Act <- doc1 %>% 
  filter(category=="Actif") %>% 
  rename(PC_act=values) %>% 
  filter(sex !="T")

## doc 2 : PC_Emp 
doc2 <- doc2 %>% 
  rename(educ_level=isced11, country=geo, PC_emp=values)  %>%
  filter(educ_level !="NRP")
doc2$educ_level <- car::recode(doc2$educ_level,'"ED0-2"="low";"ED3_4"="Inter";"ED5-8"="high"')
PC_Emp <- doc2

## doc 3 : PC_Partime 
PC_Partime <- doc3 %>% 
  rename(country=geo, PC_parttime_onemp=values) %>% filter(citizen=="TOTAL")%>%
  select(-"citizen")

## doc 4 : PC_Temp 
doc4 <- doc4 %>% 
  rename(country=geo, PC_emp=unit)  %>% 
  filter(reason !="NRP") 
doc4$PC_emp <- car::recode(doc4$PC_emp,'
  "PC_SAL"="employment";"PC_SAL_TEMP"="Temporary"')
doc4$reason <- car::recode(doc4$reason,'
  "INVTMP"="NocoulJob";"WANTTMP"="NowantJob"')
PC_Temp <- doc4

## doc 5 : PC_Unemp 
PC_Unemp <- doc5 %>% 
  rename(country=geo, PC_unemp=unit) %>% 
  filter(PC_unemp !="THS_PER", PC_unemp !="PC_POP") %>% ### def chomage = unemp / pop active
  select(-PC_unemp) %>% 
  rename(PC_unemp=values)

## doc 6 : PC_Ltunemp 
PC_Ltunemp <- doc6 %>% 
  rename(country=geo, PC_unemp=values) %>% 
  filter(unit !="THS_PER") %>% 
  select(-indic_em)

## doc 7 : Pop_evol 
doc7$indic_de <- car::recode(doc7$indic_de,'"JAN"="T";"MJAN"="M";"FJAN"="F"')
doc7 <- doc7  %>%  filter(indic_de %in% c("T","M", "F"))
Pop_evol <- doc7

## doc 8 : GDPandVA 
GDPandVA <- doc8  %>%  
  rename(country=geo) %>% 
  filter(na_item %in% c("B1GQ","B1G"))  %>%  
  filter(unit == "CP_MEUR",na_item=="B1G")%>% select(-"unit",-'na_item')
  

## doc 9 : PC_Gapaid 
PC_Gapaid <- doc9 %>% 
  rename(country=geo, PC_gap=values)
PC_Gapaid2 <- PC_Gapaid %>% 
  group_by(country, time) %>%
  summarise(mean_gappaid_percountry = mean(PC_gap))

## doc 10 : Number of Birth 
Birth = doc10 %>% rename(country=geo)
Birth$values=Birth$values/1000
```

## Intro

<p style="text-align:justify;"> 
  Based on a figure provided by Eurostat, the European Union's statistical agency, which states that "French women earn 15.4% less than men", meaning that they work on a voluntary basis from 5 November at 16:47 until 31 December. 
  As french women that are going to enter the world of work in the years to come, the authors decided in this report to focus on the topic of gender equality in the working place throughout Europe. Therefore this study will be a comparison of data collected in each European country from 2006 to 2018 on 18-64 year old population. The data used can be found on Eurostat open source database (see references in the source section). The period studied has been chosen depending on the available data and allow to provides a pre/post financial crisis analysis. The age group studied is the most appropriate considering that most citizens enter the world of work at least at the age of 18 and leave it at around 64. 
  The objective is to see if the working place is becoming more egalitarian over the years. Who are today the good students and the bad students in terms of gender equality at work? We may have in mind that the best countries on gender equality matter are nordic countries, but are the results consistent with the assumptions we have? 
  This analysis is exploring the difference between men and women on: activity rate, long-term unemployment rate, part-time employment, temporary employment and gap paid (divided into 6 parts), in order to discover which country is the best to work in Europe when you are a woman. </p>

## Methodology 

<p style="text-align:justify;"> The first step was to import the dataframe from Eurostat open source database with the Eurostat package. Then, the following step was to tidy the dataframe in order to only have the data needed for the analysis and classify them to make it easier for r to make graphs. It means suppressing the missing value, filtering only the interesting data for the analysis (countries, period, age) and changing wide dataframe to long dataframe. The third step was to analyse and make the data speak for themselves by creating plots. The last one was to try to find explanatory variables to those results by comparing them with socio-demographic variables through correlation analysis. </p>

## Part 1: Activity rate evolution and difference 


#### Evolution of activity rate in Europe from 2006 to 2018: Man VS. Woman
```{r}
GDP=GDPandVA%>%filter(! country %in% c("EA","EA12", "EA19","EU15", "EU28", "EU27_2019"))

```

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}

###### I a) Evolution of activity rate in UE of 28, between woman & man

# Activity rate of European woman in 
# a data frame with all the annotation info

ARF06=PC_Act %>% filter(country =="EU28",sex=="F",time=="2006")%>% select(PC_act)
ARF18=PC_Act %>% filter(country =="EU28",sex=="F",time=="2018")%>% select(PC_act)
ARM06=PC_Act %>% filter(country =="EU28",sex=="M",time=="2006")%>% select(PC_act)
ARM18=PC_Act %>% filter(country =="EU28",sex=="M",time=="2018")%>% select(PC_act)

# Create a text
grobF <- grobTree(textGrob(c(ARF06,ARF18), x=c(0.01,0.9) , y=c(0.45,0.5), hjust=0,
  gp=gpar(col="red", fontsize=10)))
grobM <- grobTree(textGrob(c(ARM06,ARM18), x=c(0.01,0.9) , y=c(0.9,0.95), hjust=0,
  gp=gpar(col="Blue", fontsize=10)))

PC_Act %>% 
  filter(country =="EU28") %>% group_by(sex)%>% ggplot(.,) +
  geom_line(aes(x=time,y=PC_act,colour=sex,group=sex),size=1) +  
  labs(title="Evolution of Activity rate between woman & men ") +
  xlab("Year") + ylab("Activity rate")+ ylim(40,90)+
  theme(axis.text.x = element_text(angle=38)) +
  annotation_custom(grobM)+annotation_custom(grobF)

# Code Ã  mettre dans le paragraphe

EUR28_men_activityrate_2018 <- PC_Act[57,5]
print(EUR28_men_activityrate_2018)
EUR28_wom_activityrate_2018 <- PC_Act[16,5]
print(EUR28_wom_activityrate_2018)
library(mosaic)
betaslope_wom<- PC_Act %>% filter(time <= 2011, sex%in%c("F"), country=="EU28")
betaslope1 <- lm(formula=betaslope_wom$time~betaslope_wom$PC_act,data=betaslope_wom)
betaslope1=coef(betaslope1)[2]

betaslope_tot <- PC_Act%>% filter(time<=2011, country=="EU28")
betaslope2 <- lm(formula=betaslope_tot$PC_act~betaslope_tot$time, data=betaslope_tot)
betaslope2<-coef(betaslope2)[2]  ### voir pour arrondir
print(betaslope2)

betaslope_tot <- PC_Act%>% filter(time<=2011, country=="EU28")
betaslope2 <- lm(formula=betaslope_tot$PC_act~betaslope_tot$time, data=betaslope_tot)
betaslope2<-(coef(betaslope2)[2]) ### voir pour arrondir
print(betaslope2)



activityrate_m2006 <- PC_Act[994,5]
activityrate_w2006 <- PC_Act[956,5]
gap_activityrate_2006 <- activityrate_m2006 - activityrate_w2006

activityrate_m2018 <- PC_Act[57,5]
activityrate_w2018 <- PC_Act[16,5]
gap_activityrate_2018 <- activityrate_m2018 - activityrate_w2018
```

<p style="text-align:justify;"> The activity rate increase between 2006 and 2018 for both women and men overall. Generally, women always have an activity rate lower than the men. 
We can notice that 2011 is a turning point: Before 2011, the activity rate for men was stagnating around 83% while activity rate for women was increasing. After 2011, the activity rate for men start to slightly increase to reach `r EUR28_men_activityrate_2018` in 2018. Concerning, women activity rate after 2011, it keep increasing a bit faster than before 2011: Indeed, The Beta of the trend before 2011 was `r betaslope1` while the Beta after 2011 was `r betaslope2`.  Women activity rate finally reach `r EUR28_wom_activityrate_2018` in 2018. 
Despite, a positive evolution of the activity rate for women for the concerned period, the gap between men and women activity rate remain almost unchanged. In 2006, the difference in percentage between men and women activity rate was `r gap_activityrate_2006` while in 2018 this gap in percentage was `r gap_activityrate_2018`.  </p>

### Gap activity rate 2018 in Europe

```{r, message=FALSE, warning=FALSE, fig.align='center'}

### CACHER MESSAGE ET WARNING

###### I b) Cartograme, Gap Activity Rate Zone UE

# Data pour gap activity rate
PC_GapFem= PC_Act %>% filter(sex=="F")
PC_GapFem=PC_GapFem %>% rename(f_act= PC_act) 
PC_GapFem=PC_GapFem%>%  select(f_act,time,country)
PC_GapMal= PC_Act %>% filter(sex=="M")
PC_GapMal=PC_GapMal%>%rename(m_act= PC_act) %>% select(m_act,time,country)
PC_ActGap=left_join(PC_GapFem,PC_GapMal,by=c('time','country'))

PC_ActGap$gap=PC_ActGap$m_act-PC_ActGap$f_act

# Mise en place pour cartogram
PC_ActGapTime=PC_ActGap
PC_ActGap=PC_ActGap %>% 
  filter(! country %in% c("EA17","EA18","EA19","EU15","EU28"))%>% 
  select(- f_act,m_act)%>%filter(time=="2018")

PC_ActGap <- PC_ActGap %>% 
  rename(CNTR_CODE=country) 

PC_ActGap$class=cut_to_classes(PC_ActGap$gap, n=10, style="equal", decimals=1)
geodata <- get_eurostat_geospatial(resolution = "60", nuts_level = "2", year = 2016)
map_data <- inner_join(geodata, PC_ActGap)

#cartogram 
ggplot(data=map_data) + geom_sf(aes(fill=class),color="dim grey",size=0.1)+
    scale_fill_brewer(palette = "RdBu") +
    guides(fill = guide_legend(reverse=T, title = "euro")) +
    labs(title="Gender Gap of Activity rate in European Country in 2018") +
    theme_light()  +
    coord_sf(xlim=c(-40,44), ylim=c(25,70))

### voir si on peux faire cartogram animÃ©e avec toute les annÃ©es et pays change de couleur en fonction de l'Ã©volution

```

<p style="text-align:justify;"> Countries in red are those with the lowest gap of activity rate between woman and men. On the map above, we can see that the countries with the lowest gap of activity rate are mostly countries from the north of Europe : The scandinavian peninsula countries (Norway, Finland, Sweden, Denmark and Iceland), two other countries from the baltic region (Latvia and Lithuania) plus Portugal and Romania. The results concerning the Scandinavian countries are consistent with the expectations because scandinavian countries are known to be equalitarian on gender matter. However, it is a little more surprising for the other countries. Even more surprising the country with the lowest activity rate gap isis Lithuania with ` r min_gapact ` % of gap between men and women for activity rate. This can be explain by the regulation there. Artcile 7 of  the LET (Lithunia on Equal Treatment) which prohibits discrimination in the job market on the grounds of gender, race, nationality, language and so on. The Office of Equal Opportunities Ombudsperson monitors and controls the implementation of this regulation by employers for exemple. 

The countries with the higher gap of activity rate are depicted in dark and light blue. The one with the higher gender gap is â¦ (mettre code pour Turkey) with â¦ (mettre code pour %). This is consistent because Turkey is a country where the major religion is Islam and usually islamic woman are not allowed to work (with some exceptions). But we will not used Turkey for further analysis because it is not within the European Union. The higher gender gap within european countries can be found in Italy with ` r Italy_gap ` % .

In 2007 a National reform plan was undertaken by the Italian government called the "Libro Verde" in order to increase women participation in the labour market such as the improvement of the quality of childcare services. This is important to underline the fact that women are less present in the labour force particularly because of the double burden of having to conciliate work life and family life. Despite these reforms, the figures speak for themeselves, Italian women are still not enough present in the labour market. But whi is that? The origins can  be found in Childhood, women are taught to know how to keep a house (cooking, cleaning, taking c care of the children and of their husband) meanwhile men are responsible for providing the family needs by working and earning money. Once again again, why is it like this? We can aslo find sources in Religion. Italy more than other countries in Eurrope is deeply influenced by the Bible, majority of Italians are Christians, 88% of them belong to the oman Catholic Church. </p>

### Correlation between the activity rate and the activity rate gap in 2006, 2010 and 2018 for all European countries

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}

##### I c) CorrÃ©lation taux d'activitÃ© total & Gap taux d'activitÃ© in 2006-2010-2018

PC_Act_Gap_col1=doc1 %>% filter(sex=="T") %>% filter(category=="Actif") %>%select(values, time, country)
PC_Act_Gap_col2=PC_ActGapTime %>% select(gap, time, country)
PC_Act_Gap=inner_join(PC_Act_Gap_col1, PC_Act_Gap_col2, by=c('time','country'))

PC_Act_Gap=PC_Act_Gap %>% filter(! country %in% c("EA17","EA18","EA19","EU15","EU28")) %>%
  filter(time == c("2006", "2010", "2018"))

## Graphique animate

### first attempt : gganimate

PC_Act_Gapbis=PC_Act_Gap %>% filter(! country %in% c("EA17","EA18","EA19","EU15","EU28")) 

gganimate_1 <- ggplot(data = PC_Act_Gapbis, aes(x=values, y=gap, color=country)) +
  geom_point(alpha = 0.5) +
  labs(x = "Total activity rate", y = "Activity gap between men and women") +
  transition_states(time, 3, 1) + 
  ease_aes('cubic-in-out')

gganimate_1

### AJOUTER LES ANNEES EN FOND

## tendance gÃ©nÃ©ral : plus le taux d'activitÃ© est haut et plus l'Ã©cart entre taux d'activitÃ© H et F est faible
#################### AJOUTER LEGENDES ET CHANGER NOM DES AXES

## Calculer coef de correlation 
cor(PC_Act_Gap$values, PC_Act_Gap$gap, method="pearson")
## -0,85 = fortement corrÃ©lÃ© nÃ©gativement (variable Ã©volue sens inverse de l'autre) ET CACHER RESULTAT MAIS L'AJOUTER DANS UNE PHRASE

## Outliers to identify (hors trend)

### Outliers 2006
PC_Act_Gap %>%
  filter(time == "2006") %>%
  filter(gap>30) %>%
  select(time, country, values, gap)
### MT, TR

### Outliers 2010
PC_Act_Gap %>%
  filter(time == "2010") %>%
  filter(gap>30) %>%
  select(time, country, values, gap)
### MT, TR
### CACHER RESULTAT MAIS L'AJOUTER DANS UNE PHRASE

### Outliers 2018
PC_Act_Gap %>%
  filter(time == "2018") %>%
  filter(gap>30) %>%
  select(time, country, values, gap)
### No outliers, why ???
```

<p style="text-align:justify;"> The correlation between the activity rate and the gap activity rate for the years 2006,2010,2018 is    â r cor_gap â ,  this is negative a only tells us that the two variables, activity rate and gap activity rate are evolving in differents way. Letâs now see the correlation between gap activity rate and the GDP in 2018. The correlation is â r cor_GDP â , this underlines a small correlation between gap activity rate and GDP in EU for 2018. Commonly, the GP is a indicator of the wealth of a country, since the correlation is not that strong we canât really say thereâs a link.. </p>

### Correlation between the activity rate gap and the GDP in 2006, 2010 and 2018 for all European countries

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}

##### I d)CorrÃ©lation Gap activity rate and GDP in 2018

## Calculer coef de correlation 
cor(PC_Act_Gap$values, PC_Act_Gap$gap, method="pearson") ## CACHER CALCUL

## VÃ©rification graphique
PC_GDP_Gap_col1 <- GDPandVA  %>% 
  select(values, time, country) %>% 
  filter(! country %in% c("EA","EA12", "EA19","EU15", "EU28", "EU27_2019")) 
  
PC_GDP_Gap_col2 <- PC_ActGapTime %>% 
    select(gap, time, country) %>% 
    filter(! country %in% c("EA17","EA18","EA19","EU15","EU28"))

PC_GDP_Gap=inner_join(PC_GDP_Gap_col1, PC_GDP_Gap_col2, by=c('time','country'))

PC_GDP_Gap=PC_GDP_Gap %>% filter(time == c("2006", "2010", "2018"))

ggplot(data = PC_GDP_Gap, aes(x=values, y=gap, color=country)) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
   facet_wrap(~time) 

## Calculer coef de correlation 
cor(PC_GDP_Gap$values, PC_GDP_Gap$gap, method="pearson")
## 0,26 = faiblement corrÃ©lÃ© positivement 

### faire correlogram animÃ©e pour toutes les annÃ©es 
```

<p style="text-align:justify;"> Letâs now see the correlation between gap activity rate and the GDP in 2018. The correlation is â r cor_GDP â , this underlines a small correlation between gap activity rate and GDP in EU for 2018. Commonly, the GP is a indicator of the wealth of a country, since the correlation is not that strong we canât really say thereâs a link. </p>

```{r, Activity rate e, results='hide', fig.align='center'}

# Find the country with the lowest gap activity rate between woman & men  
mingap2018=min(PC_ActGap$gap) # LT lituania 3.8
PC_ActGap%>%filter(gap==mingap2018)%>%select(CNTR_CODE)


# Find the country with the higher woman activity rate  
maxgap2018=max(PC_ActGap$gap) # Turquey 43%
PC_ActGap%>%filter(gap==maxgap2018)%>%select(CNTR_CODE)

# Find the country with the higher woman activity  in Europe  
gap2018EU= PC_ActGap %>% 
  filter(! CNTR_CODE %in% c("EA17","EA18","EA19","EU15","EU28","TR","MK","MT"))
max2018UE=max(gap2018EU$gap) #20.6 Italy
gap2018EU%>%filter(gap==max2018UE)%>%select(CNTR_CODE)


# find the country  with the median gap activity rate

gapmoy=median(gap2018EU$gap) #9.5
gap2018EU%>% filter(gap==gapmoy)%>%select(CNTR_CODE) # BE,Belgium

# text for plot
li06=PC_ActGapTime%>%filter(time==2006,country=='LT')%>%select(gap)
li06=round(li06,2)
Lit <- grobTree(textGrob(c(li06,mingap2018), x=c(0.01,0.9) , y=c(0.2,0.12), hjust=0,
  gp=gpar(col="Blue", fontsize=10)))
it06=PC_ActGapTime%>%filter(time==2006,country=='IT')%>%select(gap)
Ita <- grobTree(textGrob(c(it06,max2018UE), x=c(0.01,0.9) , y=c(0.9,0.7), hjust=0,
  gp=gpar(col="Green", fontsize=10)))
be06=PC_ActGapTime%>%filter(time==2006,country=='BE')%>%select(gap)
Bel<- grobTree(textGrob(c(be06,gapmoy), x=c(0.01,0.9) , y=c(0.6,0.38), hjust=0,
  gp=gpar(col="Red", fontsize=10)))

# graph of the evolution of 3 country over time for gap activity rate
PC_ActGapTime %>% 
  filter(country %in%c("IT","BE","LT")) %>% group_by(country)%>% ggplot(.,) +
  geom_line(aes(x=time,y=gap,colour=country,group=country),size=1) +
  labs(title="Evolution of gap activity rate over time  ") + xlab("time") +
  ylab("gap paid") +
  scale_color_discrete(label= c("Belgium"," Italy", "Lithuania")) + theme_light() +
  theme(axis.text.x = element_text(angle=38))+ annotation_custom(Bel)+annotation_custom(Bel)+annotation_custom(Ita)+annotation_custom(Lit)
```

<p style="text-align:justify;"> We are focusing on 3 countries to see how they have evolved over time. W focused on the coutry with the highes activity gap (Italy), the lower gap (Lithiania) and the median gap (Belgieum) with â r gap_BE â . We have already discussed why we had those results for the first two, now letâs see why does Belgium has an activity gap rate that is higher than Lithuania. The reason behind a relatively important activity rate gap in Belgium is not legislation, itâs people state of mind. When asking to women why they think thereâs such a gap between men and women in the labour market, â of them argue it is because it would have an negative impact on their careers to be wom, once again the double burden of being a woman in the labor force plays a role here. According to âBelgium men, equality in employment opportunity for both gender is not yet a reality. The general tendency for the three countries is that gap activity rate is reducing in the period between 2006 and 2018. Going from â  r gap2006_It â to â r gap2018_It â , from â r gap2006_Bel â to â r gap2018_Bel â and from â r gap2006_Lit â to â r gap2018_Lit â .  </p>

## Part 2: Unemployment rate evolution and difference
```{r, message=FALSE, warning=FALSE, fig.align='center'}

##### II a) Evolution of unemployment over the time in EU
PC_UnempUE=PC_Unemp %>% 
  filter(country =="EU28") %>% filter(!sex%in%("T")) %>% group_by(sex)
ggplot(PC_UnempUE) +
   geom_line(aes(x=time,y=PC_unemp,group=sex,colour=sex),size=0.5) + labs(title="Evolution of Unemployent Rate between wooman & men ") + xlab("time") + ylab("Unemployment rate")+ ylim(5,15)+theme(axis.text.x = element_text(angle=45))+geom_vline(xintercept = 9,
                color = "purple", size=1.5) + theme_classic()+theme(axis.text.x = element_text(angle=38))

```

<p style="text-align:justify;"> From 2006 and 2018 the unemployment rate for both men and women dÃ©creased slightly from â r une_men_2000 âto â r une_men_2018 â and from â r une_wom_2000 â to â r une_wom_2018 â . At the beginning we had  gap of over 2.5 % between men and women for unemployment, as both unemployment rate are decreasing the gap is still not closing before 2008. From 2008 the gap may have reduced, unemployment is raising for both sex until 2013. There are 2 main reasons behind it. First, the Financial crisis is touching Europe from 2008 a year after the US, one year after that Europe has to face its own debt crisis which started in  Greece.. Companies, unable to refinance their governments are strike with the consequences of both crisis. A lot of them stopped hiring people and even firing some people because they canât keep up . After 2013, unemployment is decreasing for both men and women and in the meantime, it seems like the gap is also trying to come back to how it was before the crisis . We can argue that the reason why the unemployment rate was closing after the crisis is because in desperate times it might not make a difference that youâre a man or woman.  </p>

## Part 3: Part-time employment 

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}
##### IV a) Cartographie partime total

# cartographie Total

PC_Partimecarte=PC_Partime %>% 
  filter(! country %in% c("EA17","EA18","EA19","EU15","EU28")) %>%
  filter(sex=="T",time=="2018")

PC_Partimecarte$class = cut_to_classes(PC_Partimecarte$PC_parttime_onemp, n=5,
                                       style="equal", decimals=1)

geocart <- get_eurostat_geospatial(resolution = "60", output_class = "df")
geocart <- geocart %>% 
  rename(country =CNTR_CODE)
 
mapdatapartime <- PC_Partimecarte%>%
  inner_join(geocart, by = "country")

ggplot(mapdatapartime, aes(x = long, y = lat, group = group))+
  geom_polygon(aes(fill=class), color="grey", size = .1)+ 
  scale_fill_brewer(palette ="Set2") +
  labs(title="Part time throughout Europe, 2017",
             fill="Part-time employment") + theme_light()+
  coord_map(xlim=c(-40,40), ylim=c(25,73))

# changer les couleurs
### faire cartogram animÃ©e pour toutes les annÃ©es 


```

<p style="text-align:justify;"> We have 4 categories of Part-time employment rate for women throughout Europe in 2017. Surprisingly, countries of eastern Europe have the lowest percentage of women having part time employment. It goes from 1.8% to 10.8% , letâs also add that the country with the lowest women in part time employment is within this group, itâs Bulgaria. Countries with a âmediumâ rae of part time employment for women are in Western Europe for the most part, it goes from 10.8% to 19.8% . Countries from Northern Europe have more women doing part time jobs (19.8% to 28.8%) . The country with the highest rate of women in part time employment is Netherlands. Now we will try to find explanations to these results. </p>

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}

##### IV b) 3 graphs 
# Gap H - F

TabF=PC_Partime %>% filter(sex=="F") %>% rename(PC_PF= PC_parttime_onemp)%>% select(-"sex")
TabH=PC_Partime %>% filter(sex=="M") %>% rename(PC_PH= PC_parttime_onemp)%>% select(-"sex")
PartTime=left_join(TabF,TabH,by=c('country','time'))
PartTime$gap=PartTime$PC_PF-PartTime$PC_PH

# choose 3 country
PartTime2018=PartTime%>% filter(time=="2018")%>% filter(! country %in% c("EA17","EA18","EA19","EU15","EU28","ME","MK","TR")) 

# negative for Montenegro so Men are more precare than woman
# Country with the lowest precarity gap

minpt2018=min(PartTime2018$gap)# 0.1 
mincountrypt2018=PartTime2018%>%filter(gap==minpt2018)%>%select(country)
mincountrypt2018 # BG, Bulgaria # 0.4

# Country with the higher precarity  gap
maxpt2018=max(PartTime2018$gap)# 58.3
maxcountrypt2018=PartTime2018%>%filter(gap==maxpt2018)%>%select(country)
maxcountrypt2018 #NL Netherland 

# Country with the median gender paid gap
#medpt2018=median(PartTime2018$gap) #20.3 
#medcountpt=PartTime2018 %>% filter(gap==20.3)%>%select(country)
# medcountpt # Norway

# European gender paid gap
EUpt=PartTime%>%filter(country=="EU28",time=="2018")%>%select(gap)
EUpt# 22.8

# graph of the evolution of 3 country over time forpart time activity rate
PartTime %>% 
  filter(country %in%c("NO","BG","NL")) %>% group_by(country)%>% ggplot(.,) +
  geom_line(aes(x=time,y=gap,colour=country,group=country),size=1) +
  labs(title="Evolution of par ime gap activity rate over time  ") + xlab("time") +
  ylab("gap paid") +
  scale_color_discrete(label= c("Netherland","Norway", " Bulgaria")) + theme_light() +
  theme(axis.text.x = element_text(angle=38))

# correlation
# avec le taux de naissance ( plus enfant plus de part time des femmes) 
```
```{r}

# correlation betwenn woman part time rate and rate of birth

# create data
Birth=Birth %>% filter(! country %in% c("EA17","EA18","EA19","EU15","EU28"))
PartF=PC_Partime%>% filter(! country %in% c("EA17","EA18","EA19","EU15","EU28"),sex=="F") %>%select("time","country","PC_parttime_onemp")
Corrbirth= left_join(Birth,PartF,by=c("time","country"))
# Some country are not in the both table so we remove NA
any(is.na(Corrbirth))
Corrbirth=na.omit(Corrbirth)
# animate correlation
gganimate_10 <- ggplot(data = Corrbirth, aes(x=values, y=PC_parttime_onemp, color=country)) +
  geom_point(alpha = 0.5) +
  labs(x = "Total Birth", y = "PC of partime activity for woomen") +
  transition_states(time, 3, 1) + 
  ease_aes('cubic-in-out')+
  shadow_wake(wake_length = 0.1, alpha = FALSE)
 
gganimate_10
```
<p style="text-align:justify;"> Bulgaria is the country in Europe with le lowest rate of women in part time jobs, in 2006 it was 0.4% , it went to 0.1% in 12 years. An article from the World Bank published in March 2019 called â Bulgaria Emerges as champion in Women Legal Rights Affecting Work â help us understand this figure. Bulgaria is one of the 6 countries that removed all job restrictions on women over 10 years. The government wants to ensure gender equality in labour market, they believe that a world where women who have the skills to work in what they want to work would not only be fairer but also could benefit all. Women in Bulgaria occupy important high posts in politics, the President of the Parliament is a woman, so is he capital city mayor and 2 deputies ministers. 
There are  way more women doing part time job in Netherlands, they are 58.3 percent. From 1980 to 2016 women have been more present in the labour force, the percentage of women working in the Netherlands went from 35% to 70% , but 60% of them are actually doing part time jobs. Part time jobs offers job satisfaction, free time for children care and also free time for leisure activities. In Netherlands, the average father works five days a week whereas the average mother works 3 days a week, this can be explained by the fact that twice as many women as men look after the household and children.  </p>

## Part 4: Temporary employment 

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}
##### V a)



# How country have the hightest rate of woman that didn't want to find a permanent job
# doc4 = PC_Temp

NowantF=PC_Temp%>%filter(time=="2018" & sex=="F"& reason=="NowantJob")
maxnowant=max(NowantF$values)
NowantF%>%filter(values==maxnowant) # SlovÃ©nie 46.5%
```

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}
##### V b) No couldt find permanent job gap 

# create data 
NocouldF=PC_Temp%>%filter(sex=="F", reason=="NocoulJob",PC_emp=="Temporary")%>%
  select(time,country,values)%>% rename("VF"="values")
NocouldM=PC_Temp%>%filter(sex=="M", reason=="NocoulJob",PC_emp=="Temporary")%>%
  select(time,country,values)%>% rename("VM"="values")
Gapnocould=left_join(NocouldF,NocouldM,c("time","country"))
Gapnocould$gap=Gapnocould$VM-Gapnocould$VF

# Graph UE

Gapnocould %>%filter(country=="EU28")%>% ggplot(.,)+
  geom_line(aes(x=time,y=gap,group=1),size=1)+ylim(-10,10)+
  geom_vline(xintercept = 2 , color = "blue", size=1)+
  geom_vline(xintercept = 9 , color = "blue", size=1)+
  labs(title="Gap to find a permanent job, evolution")

# cartogrphy of european  country gap 
# Mise en place pour cartogram
Gapnocouldbis=Gapnocould %>% 
  filter(! country %in% c("EA17","EA18","EA19","EU15","EU28"))%>% 
  select(-VF,-VM)%>%filter(time=="2018")

Gapnocouldbis=Gapnocouldbis %>% 
  rename(CNTR_CODE=country) 

Gapnocouldbis$class=cut_to_classes(Gapnocouldbis$gap, n=5, style="equal", decimals=1)
geodata <- get_eurostat_geospatial(resolution = "60", nuts_level = "2", year = 2016)
map_data <- inner_join(geodata, Gapnocouldbis,"CNTR_CODE")

#cartogram 
ggplot(data=map_data) + geom_sf(aes(fill=class),color="dim grey",size=0.1)+
    scale_fill_brewer(palette = "RdBu") +
    guides(fill = guide_legend(reverse=T, title = "euro")) +
    labs(title="Gap of difficiluties to find a permanent job") +
    theme_light()  +
    coord_sf(xlim=c(-40,44), ylim=c(25,70))

```

## Part 5: Gap paid 

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}

#### VI a)graph of the evolution of Gap paid in Europe 
PC_Gapaid2 %>% 
  filter(country == "EU28")%>% ggplot(.,) +
  geom_line (aes(x=time,y=mean_gappaid_percountry,group=1 ) ,size=2) + 
  labs(title="Evolution of gap paid over time in Europe  ") + xlab("time") +
  ylab("gap paid") +
  theme_light() + geom_vline(xintercept = 2, color = "purple", size=1.5) + 
  geom_vline(xintercept = 4 , color = "purple", size=1.5)
            
```

<p style="text-align:justify;"> Between 2010 and 2017, the gap paid between men and women decreased by 1.1% from 17,10% to 16% . Between 2011 and 2012 we had an slight increase up to 17.4% for the gap, right after this period we have a progressive decrease. What can explain this tendency? Since 2009, the Academy of European Law host annual seminars to discuss european law on equality between women and men. From 2014 to 202, series of seminars in the framework of the European Commissionâs Right, Equality and Citizenship Programme have been held and will be host to fight inequality. </p>

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}
# #### VI b) Cartogram mean gap paid by gender between european countries in 2017
 
datacart <- get_eurostat(id= "earn_gr_gpgr2", time_format = "date", filters = "none",
type = "code", cache = TRUE) %>% 
  filter(time == "2017-01-01") %>%
  group_by(geo) %>%
  summarise(mean_gappaid_percountry = mean(values)) %>%
  mutate(cat = cut_to_classes(mean_gappaid_percountry, n=7, decimals=1))
 
geocart <- get_eurostat_geospatial(resolution = "60", output_class = "df")
 
mapdata <- datacart %>%
  inner_join(geocart, by = "geo")
 
head(select(mapdata,geo,mean_gappaid_percountry,cat,long,lat,order,id))
 
ggplot(mapdata, aes(x = long, y = lat, group = group))+
  geom_polygon(aes(fill=cat), color="grey", size = .1)+ scale_fill_brewer(palette = "YlOrRd") +
  labs(title="Gap paid between men and women throughout Europe, 2017",
       subtitle="Avg. gap paid per country",
       fill="Gap paid (%)") + theme_light()+
  coord_map(xlim=c(-40,40), ylim=c(25,73))

```

<p style="text-align:justify;"> Thereâs a lot of different situations in Europe regarding the gap paid between men and women in 2017. Some countries from Eastern Europe have a huge gap in wages from 15.6% to 20%, nordic countries score quite well with a gap going from 4.7% to 13. For countries from Western Europe itâs a mix of both situation. We will be focusing on 3 countries : Estonia with the highest gap, Finland with the median gap and finally Roumania with the lowest gap. </p>

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}

# filter PC_Gapaid2 for work on max min medium
PC_Gapaid22017=PC_Gapaid2%>% filter(time=="2017")

# Country with the lowest gender paid gap
minGP2017=min(PC_Gapaid22017$mean_gappaid_percountry)
mincountGP=PC_Gapaid22017 %>% filter(mean_gappaid_percountry==minGP2017)%>%select(country)
mincountGP # RO, Roumania # 4.73% ( puis Marlte Belgique)

# Country with the hogher gender paid gap
maxGP2017=max(PC_Gapaid22017$mean_gappaid_percountry)

maxcountGP=PC_Gapaid22017 %>% filter(mean_gappaid_percountry==maxGP2017)%>%select(country)
maxcountGP # EE,Estonia # 20%, Republique Tcheque Autriche 

# Country with the median gender paid gap
median(PC_Gapaid22017$mean_gappaid_percountry) #13.52 we don't find this in our data 
medcountGP=13.5
medcountGP=PC_Gapaid22017 %>% filter(mean_gappaid_percountry==13.5)%>%select(country)
medcountGP # Finland

# European gender paid gap
EUGP=PC_Gapaid22017%>%filter(country=="EU28")
EUGP # 16%

##### VI c)  graph of the evolution of 3 gap wages over tme

PC_Gapaid2 %>% 
  filter(country %in%c("FI","EE","RO")) %>% group_by(country)%>% ggplot(.,) +
  geom_line(aes(x=time,y=mean_gappaid_percountry ,colour=country,group=country),size=1) +
  labs(title="Evolution of gap paid over time  ") + xlab("time") + ylab("gap paid") +
  scale_color_discrete(label= c(" Estonia", "Finland", "Roumania")) + theme_light() +
  theme(axis.text.x = element_text(angle=38))
```

## Conclusion

```{r, message=FALSE, warning=FALSE, results='hide', fig.align='center'}
library(crayon)
```

## Reference

### Open source data from Eurostat

- Employment and activity by sex and age - annual data from 2006 to 2018:
https://appsso.eurostat.ec.europa.eu/nui/show.do?query=BOOKMARK_DS-053312_QID_-4AAC19A_UID_-3F171EB0&layout=SEX,L,X,0;GEO,L,Y,0;AGE,L,Z,0;UNIT,L,Z,1;TIME,C,Z,2;INDIC_EM,L,Z,3;INDICATORS,C,Z,4;&zSelection=DS-053312INDIC_EM,EMP_LFS;DS-053312AGE,Y15-64;DS-053312TIME,2015;DS-053312UNIT,PC_POP;DS-053312INDICATORS,OBS_FLAG;&rankName1=UNIT_1_2_-1_2&rankName2=AGE_1_2_-1_2&rankName3=INDICATORS_1_2_-1_2&rankName4=INDIC-EM_1_2_-1_2&rankName5=TIME_1_0_0_0&rankName6=SEX_1_2_0_0&rankName7=GEO_1_2_0_1&rStp=&cStp=&rDCh=&cDCh=&rDM=true&cDM=true&footnes=false&empty=false&wai=false&time_mode=ROLLING&time_most_recent=true&cfo=%23%23%23%2C%23%23%23.%23%23%23&lang=en
- Employment rates by sex, age and educational attainment level - annual data from 2006 to 2018:
https://appsso.eurostat.ec.europa.eu/nui/show.do?query=BOOKMARK_DS-055844_QID_-6C2A0300_UID_-3F171EB0&layout=SEX,L,X,0;GEO,L,Y,0;TIME,C,Z,0;AGE,L,Z,1;ISCED11,L,Z,2;UNIT,L,Z,3;INDICATORS,C,Z,4;&zSelection=DS-055844TIME,2014;DS-055844AGE,Y15-64;DS-055844UNIT,PC;DS-055844ISCED11,ED5-8;DS-055844INDICATORS,OBS_FLAG;&rankName1=TIME_1_0_-1_2&rankName2=ISCED11_1_2_-1_2&rankName3=UNIT_1_2_-1_2&rankName4=GEO_1_2_0_1&rankName5=AGE_1_2_-1_2&rankName6=INDICATORS_1_2_-1_2&rankName7=SEX_1_2_0_0&rStp=&cStp=&rDCh=&cDCh=&rDM=true&cDM=true&footnes=false&empty=false&wai=false&time_mode=ROLLING&time_most_recent=true&lang=EN&cfo=%23%23%23%2C%23%23%23.%23%23%23&lang=en
- Part-time employment as percentage of the total employment, by sex, age and citizenship - annual data from 2006 to 2018:
https://appsso.eurostat.ec.europa.eu/nui/show.do?query=BOOKMARK_DS-182929_QID_-642059E2_UID_-3F171EB0&layout=SEX,L,X,0;GEO,L,Y,0;TIME,C,Z,0;AGE,L,Z,1;CITIZEN,L,Z,2;UNIT,L,Z,3;INDICATORS,C,Z,4;&zSelection=DS-182929AGE,Y15-64;DS-182929CITIZEN,TOTAL;DS-182929TIME,2014;DS-182929UNIT,PC;DS-182929INDICATORS,OBS_FLAG;&rankName1=TIME_1_0_-1_2&rankName2=UNIT_1_2_-1_2&rankName3=GEO_1_2_0_1&rankName4=AGE_1_2_-1_2&rankName5=CITIZEN_1_2_-1_2&rankName6=INDICATORS_1_2_-1_2&rankName7=SEX_1_2_0_0&rStp=&cStp=&rDCh=&cDCh=&rDM=true&cDM=true&footnes=false&empty=false&wai=false&time_mode=ROLLING&time_most_recent=true&lang=EN&cfo=%23%23%23%2C%23%23%23.%23%23%23&lang=en
- Temporary employees by sex, age and main reason - annual data from 2006 to 2018: https://appsso.eurostat.ec.europa.eu/nui/show.do?query=BOOKMARK_DS-052930_QID_-D7E2DA6_UID_-3F171EB0&layout=TIME,C,X,0;GEO,L,Y,0;SEX,L,Z,0;AGE,L,Z,1;REASON,L,Z,2;UNIT,L,Z,3;INDICATORS,C,Z,4;&zSelection=DS-052930SEX,T;DS-052930UNIT,PC_SAL;DS-052930AGE,Y15-64;DS-052930INDICATORS,OBS_FLAG;DS-052930REASON,TOTAL;&rankName1=UNIT_1_2_-1_2&rankName2=REASON_1_2_-1_2&rankName3=AGE_1_2_-1_2&rankName4=INDICATORS_1_2_-1_2&rankName5=SEX_1_2_-1_2&rankName6=TIME_1_0_0_0&rankName7=GEO_1_2_0_1&sortC=ASC_-1_FIRST&rStp=&cStp=&rDCh=&cDCh=&rDM=true&cDM=true&footnes=false&empty=false&wai=false&time_mode=ROLLING&time_most_recent=false&lang=EN&cfo=%23%23%23,%23%23%23.%23%23%23&lang=en
- Unemployment by sex and age - annual average: https://appsso.eurostat.ec.europa.eu/nui/show.do?query=BOOKMARK_DS-055418_QID_75B3FF18_UID_-3F171EB0&layout=SEX,L,X,0;GEO,L,Y,0;AGE,L,Z,0;UNIT,L,Z,1;TIME,C,Z,2;INDICATORS,C,Z,3;&zSelection=DS-055418INDICATORS,OBS_FLAG;DS-055418UNIT,PC_ACT;DS-055418AGE,TOTAL;DS-055418TIME,2015;&rankName1=TIME_1_0_0_0&rankName2=UNIT_1_2_-1_2&rankName3=AGE_1_2_-1_2&rankName4=INDICATORS_1_2_-1_2&rankName5=SEX_1_2_0_0&rankName6=GEO_1_2_0_1&rStp=&cStp=&rDCh=&cDCh=&rDM=true&cDM=true&footnes=false&empty=false&wai=false&time_mode=ROLLING&time_most_recent=false&cfo=%23%23%23%2C%23%23%23.%23%23%23&lang=en
- Evolution of population: https://appsso.eurostat.ec.europa.eu/nui/show.do?dataset=demo_gind&lang=fr
- GDP per country: https://appsso.eurostat.ec.europa.eu/nui/show.do?dataset=nama_10_gdp&lang=en
- Gender paid gap from 2007 to 2017: https://ec.europa.eu/eurostat/databrowser/view/tesem180/default/table?lang=en
- Growth employment rate: https://ec.europa.eu/eurostat/databrowser/view/tesem040/default/table?lang=fr

### Complementary informations

- https://www.eurofound.europa.eu/country/lithuania#equality-and-nondiscrimination-at-work
- https://start.lesechos.fr/emploi-stages/management/a-16h38-les-femmes-deviennent-benevoles-pour-le-reste-de-l-annee-6396.php

### Useful data to upgrade rmarkdown report

- Eurostat package cheat sheet: https://rstudio.com/resources/cheatsheets/
-Create a triangle plot: https://www.rdocumentation.org/packages/plotrix/versions/3.7-6/topics/triax.plot
- Theme for graph: http://www.sthda.com/french/wiki/ggplot2-themes-et-couleurs-de-fond-les-3-elements-logiciel-r-et-visualisation-de-donnees
- To create a cartogram with eurostat package: https://statistique-et-logiciel-r.com/a-la-decouverte-des-statistiques-europeennes-deurostat/
- To create a cartogram with eurostat package: https://rdrr.io/cran/eurostat/man/get_eurostat_geospatial.html
- Coulours for graphs: http://rstudio-pubs-static.s3.amazonaws.com/5312_98fc1aba2d5740dd849a5ab797cc2c8d.html
- Help for graph: https://cedricscherer.netlify.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/#colors
- Economic activities:https://en.wikipedia.org/wiki/Statistical_Classification_of_Economic_Activities_in_the_European_Community
- Themes R markdown :https://cran.r-project.org/web/packages/prettydoc/vignettes/hpstr.html
- Gapminder: https://www.gapminder.org/tools/?from=world#$chart-type=bubbles
- Gganimate: https://github.com/thomasp85/gganimate
- Animated data vizualisation: https://towardsdatascience.com/create-hans-roslings-famous-animated-bubble-chart-in-a-single-piped-r-command-9c50a485259
- Animated data vizualisation: https://towardsdatascience.com/animating-your-data-visualizations-like-a-boss-using-r-f94ae20843e3
- Animated a card:https://d4tagirl.com/2017/05/how-to-plot-animated-maps-with-gganimate
- Plotly: https://plot.ly/r/animations/
- Create a bubble plot: https://www.r-graph-gallery.com/320-the-basis-of-bubble-plot.html
- Add labels to graph: http://directlabels.r-forge.r-project.org/

